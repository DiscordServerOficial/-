<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Squad - Vote</title>

<style>
body {
    background: #2e2e2e;
    font-family: Arial, sans-serif;
    color: white;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    margin: 0;
}

.box {
    background: #3a3a3a;
    padding: 25px;
    border-radius: 12px;
    width: 90%;
    max-width: 350px;
    text-align: center;
    box-shadow: 0 0 15px rgba(0,0,0,0.5);
}

input {
    width: 100%;
    padding: 10px;
    border-radius: 8px;
    border: none;
    margin-bottom: 10px;
    font-size: 16px;
}

button {
    width: 100%;
    padding: 12px;
    background: #4caf50;
    color: white;
    font-size: 16px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
}

#votos {
    margin-top: 10px;
    font-weight: bold;
}

#lista {
    margin-top: 10px;
    font-size: 14px;
    text-align: left;
}
</style>
</head>

<body>

<div class="box">
    <h2>ðŸŸ© Squad Minecraft</h2>
    <p>Vote no Squad</p>

    <input id="nick" placeholder="[ Seu apelido ]">
    <button onclick="votar()">Votar</button>

    <div id="votos">Votos: 0</div>
    <div id="lista"></div>
</div>

<!-- ðŸ”¥ FIREBASE (OBRIGATÃ“RIO) -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<script>
/* ðŸ”¥ CONFIG FIREBASE */
var firebaseConfig = {
  apiKey: "AIzaSyBRo7FswrF_l0Bw2jvj5KAtkLB13jagqKY",
  authDomain: "squad-74bd8.firebaseapp.com",
  databaseURL: "https://squad-74bd8-default-rtdb.firebaseio.com",
  projectId: "squad-74bd8",
  storageBucket: "squad-74bd8.appspot.com",
  messagingSenderId: "290173918460",
  appId: "1:290173918460:web:e96c1859c9911e175e4b79"
};

firebase.initializeApp(firebaseConfig);
var db = firebase.database();

/* ðŸ†” ID ÃšNICO DO DISPOSITIVO */
let deviceId = localStorage.getItem("deviceId");
if (!deviceId) {
    deviceId = "dev-" + Math.random().toString(36).substr(2, 16);
    localStorage.setItem("deviceId", deviceId);
}

/* ðŸ“Š VOTOS EM TEMPO REAL */
db.ref("votos/total").on("value", snap => {
    document.getElementById("votos").innerText =
        "Votos: " + (snap.val() || 0);
});

/* ðŸ‘¥ LISTA DE NOMES */
db.ref("votos/nomes").on("value", snap => {
    let html = "<b>Quem jÃ¡ votou:</b><br>";
    snap.forEach(child => {
        html += "â€¢ " + child.val().nick + "<br>";
    });
    document.getElementById("lista").innerHTML = html;
});

/* ðŸ—³ï¸ VOTAR */
function votar() {
    const nick = document.getElementById("nick").value.trim();
    if (!nick) {
        alert("Digite seu apelido!");
        return;
    }

    const hoje = new Date().toDateString();
    const refDevice = db.ref("votos/devices/" + deviceId);

    refDevice.once("value").then(snap => {
        if (snap.exists() && snap.val() === hoje) {
            alert("âŒ VocÃª jÃ¡ votou hoje neste dispositivo!");
            return;
        }

        refDevice.set(hoje);

        db.ref("votos/nomes/" + deviceId).set({
            nick: nick,
            data: hoje
        });

        db.ref("votos/total").transaction(v => (v || 0) + 1);

        alert("âœ… Voto computado!");
    });
}
</script>

</body>
</html>
